<section class="story-filters">
  <h3>Search</h3>
  {% assign tags = "" | split:"" %}
  {% for p in site.posts %}
    {% for t in p.tags %}
      {% unless tags contains t %}
        {% assign tags = tags | push:t %}
      {% endunless %}
    {% endfor %}
  {% endfor %}
  {% assign tags = tags | sort %}
  <div class="filters-href" id="filters-href">
    <h3>Filter<span class="filters-href-button"><i class="fa fa-chevron-down"></i></span></h3>
    <div class="filters-href-list">
      <a href="/stories/#Newest">Newest</a>
      {% for t in tags %}
      <a href="/stories/#{{ t | replace: ' ', '%20'}}">{{ t }}</a>
      {% endfor %}
      <span class="filters-href-button"><i class="fa fa-chevron-down"></i></span>
    </div>
  </div>
  <script>
    $('.filters-href-button').on('click', function(){
      var height = 10, elem = $('#filters-href');
      if(!elem.hasClass('filters-href_open')){
        height += 10;
        elem.children('.filters-href-list').children('a').each(function(index, el) {
          height += $(el).height();
        });
      }
      elem.toggleClass('filters-href_open').children('.filters-href-list').css('height', height);
    });
  </script>
  <div class="dropdown">
    <select onchange="window.location.href=this.options[this.selectedIndex].value">
      <option value="/stories/#Newest">Newest</option>
      {% for t in tags %}
        <option value="/stories/#{{ t | replace: ' ', '%20'}}">{{ t }}</option>
      {% endfor %}
    </select>
  </div>
  {% include search.html %}
  <script src="/javascripts/stories-filtering.js">
  </script>
</section>
